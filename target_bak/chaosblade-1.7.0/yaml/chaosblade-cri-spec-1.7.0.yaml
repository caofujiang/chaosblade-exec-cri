version: v1
kind: plugin
items:
- target: process
  shortDesc: Process experiment
  longDesc: Process experiment, for example, kill process
  actions:
  - action: kill
    aliases: [k]
    shortDesc: Kill process
    longDesc: The process scenario in container is the same as the basic resource
      process scenario
    matchers:
    - name: process
      desc: Process name
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: process-cmd
      desc: Process name in command
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: count
      desc: Limit count, 0 means unlimited
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: local-port
      desc: 'Local service ports. Separate multiple ports with commas (,) or connector
        representing ranges, for example: 80,8000-8080'
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: signal
      desc: Killing process signal, such as 9,15
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: exclude-process
      desc: Exclude process
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: pid
      desc: pid
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: ignore-not-found
      desc: Ignore process that cannot be found
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # Kill the nginx process in the container
      blade create cri process kill --process nginx --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Specifies the signal and local port to kill the process in the container
      blade create cri process kill --local-port 8080 --signal 15 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_killprocess
    categories:
    - system_process
    actionProcessHang: false
  - action: stop
    aliases: [f]
    shortDesc: process fake death
    longDesc: The process scenario in container is the same as the basic resource
      process scenario
    matchers:
    - name: process
      desc: Process name
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: process-cmd
      desc: Process name in command
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: count
      desc: Limit count, 0 means unlimited
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: local-port
      desc: 'Local service ports. Separate multiple ports with commas (,) or connector
        representing ranges, for example: 80,8000-8080'
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: signal
      desc: Killing process signal, such as 9,15
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: exclude-process
      desc: Exclude process
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: pid
      desc: pid
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: ignore-not-found
      desc: Ignore process that cannot be found
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # Pause the process that contains the "nginx" keyword in the container
      blade create cri process stop --process nginx --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Pause the Java process in the container
      blade create cri process stop --process-cmd java --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_stopprocess
    categories:
    - system_process
    actionProcessHang: false
  scope: cri
- target: cpu
  shortDesc: Cpu experiment
  longDesc: Cpu experiment, for example full load
  actions:
  - action: fullload
    aliases: [fl, load]
    shortDesc: cpu load
    longDesc: The CPU load experiment scenario in container is the same as the CPU
      scenario of basic resources
    flags:
    - name: cpu-count
      desc: Cpu count
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cpu-list
      desc: CPUs in which to allow burning (0-3 or 1,3)
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cpu-percent
      desc: percent of burn CPU (0-100)
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cpu-index
      desc: cpu index, user unavailable!
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: climb-time
      desc: durations(s) to climb
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cgroup-root
      desc: cgroup root path, default value /sys/fs/cgroup
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # Create a CPU full load experiment in the container
      blade create cri cpu load --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      #Specifies two random kernel's full load in the container
      blade create cri cpu load --cpu-percent 60 --cpu-count 2 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Specifies that the kernel is full load with index 0, 3, and that the kernel's index starts at 0
      blade create cri cpu load --cpu-list 0,3 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Specify the kernel full load of indexes 1-3
      blade create cri cpu load --cpu-list 1-3 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Specified percentage load in the container
      blade create cri cpu load --cpu-percent 60 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_burncpu
    categories:
    - system_cpu
    actionProcessHang: true
  scope: cri
- target: disk
  shortDesc: Disk experiment
  longDesc: Disk experiment contains fill disk or burn io
  actions:
  - action: fill
    shortDesc: Fill the specified directory path
    longDesc: The disk fill scenario experiment in the container
    matchers:
    - name: path
      desc: The path of directory where the disk is populated, default value is /
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: size
      desc: Disk fill size, unit is MB. The value is a positive integer without unit,
        for example, --size 1024
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: percent
      desc: Total percentage of disk occupied by the specified path. If size and the
        flag exist, use this flag first. The value must be positive integer without
        %
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: reserve
      desc: 'Disk reserve size, unit is MB. The value is a positive integer without
        unit. If size, percent and reserve flags exist, the priority is as follows:
        percent > reserve > size'
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: retain-handle
      desc: Whether to retain the big file handle, default value is false.
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |2

      # Fill the /home directory with 40G of disk space in the container
      blade create cri disk fill --path /home --size 40000 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Fill the /home directory with 80% of the disk space in the container and retains the file handle that populates the disk
      blade create cri disk fill --path /home --percent 80 --retain-handle --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Perform a fixed-size experimental scenario in the container
      blade c cri disk fill --path /home --reserve 1024 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_filldisk
    categories:
    - system_disk
    actionProcessHang: false
  - action: burn
    shortDesc: Increase disk read and write io load
    longDesc: Disk read and write IO load experiment in the container
    matchers:
    - name: read
      desc: Burn io by read, it will create a 600M for reading and delete it when
        destroy it
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: write
      desc: Burn io by write, it will create a file by value of the size flag, for
        example the size default value is 10, then it will create a 10M*100=1000M
        file for writing, and delete it when destroy
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: cgroup-root
      desc: cgroup root path, default value /sys/fs/cgroup
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: size
      desc: Block size, MB, default is 10
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: path
      desc: The path of directory where the disk is burning, default value is /
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # The data of rkB/s, wkB/s and % Util were mainly observed. Perform disk read IO high-load scenarios
      blade create cri disk burn --read --path /home --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Perform disk write IO high-load scenarios
      blade create cri disk burn --write --path /home --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Read and write IO load scenarios are performed at the same time. Path is not specified. The default is /
      blade create cri disk burn --read --write --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_burnio
    categories:
    - system_disk
    actionProcessHang: true
  scope: cri
- target: mem
  shortDesc: Mem experiment
  longDesc: Mem experiment, for example load
  actions:
  - action: load
    shortDesc: mem load
    longDesc: The memory fill experiment scenario in container
    flags:
    - name: mem-percent
      desc: percent of burn Memory (0-100), must be a positive integer
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: reserve
      desc: reserve to burn Memory, unit is MB. If the mem-percent flag exist, use
        mem-percent first.
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: rate
      desc: burn memory rate, unit is M/S, only support for ram mode.
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: mode
      desc: burn memory mode, cache or ram.
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: include-buffer-cache
      desc: Ram mode mem-percent is include buffer/cache
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: avoid-being-killed
      desc: Prevent mem-burn process from being killed by oom-killer
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: cgroup-root
      desc: cgroup root path, default value /sys/fs/cgroup
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # The execution memory footprint is 50%
      blade create cri mem load --mode ram --mem-percent 50 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # The execution memory footprint is 50%, cache model
      blade create cri mem load --mode cache --mem-percent 50 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # The execution memory footprint is 50%, usage contains buffer/cache
      blade create cri mem load --mode ram --mem-percent 50 --include-buffer-cache --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # The execution memory footprint is 50% for 200 seconds
      blade create cri mem load --mode ram --mem-percent 50 --timeout 200 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # 200M memory is reserved
      blade create cri mem load --mode ram --reserve 200 --rate 100 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_burnmem
    categories:
    - system_mem
    actionProcessHang: true
  scope: cri
- target: file
  shortDesc: File experiment
  longDesc: File experiment contains file content append, permission modification
    so on
  actions:
  - action: append
    shortDesc: File content append
    longDesc: 'File content append. '
    matchers:
    - name: filepath
      desc: file path
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    flags:
    - name: content
      desc: append content
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    - name: count
      desc: the number of append count, must be a positive integer, default 1
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: interval
      desc: append interval, must be a positive integer, default 1s
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: escape
      desc: symbols to escape, use --escape, at this --count is invalid
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: enable-base64
      desc: append content enable base64 encoding
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: cgroup-root
      desc: cgroup root path, default value /sys/fs/cgroup
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |
      # Appends the content "HELLO WORLD" to the /home/logs/nginx.log file
      blade create cri file append --filepath=/home/logs/nginx.log --content="HELL WORLD" --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Appends the content "HELLO WORLD" to the /home/logs/nginx.log file, interval 10 seconds
      blade create cri file append --filepath=/home/logs/nginx.log --content="HELL WORLD" --interval 10 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Appends the content "HELLO WORLD" to the /home/logs/nginx.log file, enable base64 encoding
      blade create cri file append --filepath=/home/logs/nginx.log --content=SEVMTE8gV09STEQ= --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # mock interface timeout exception
      blade create cri file append --filepath=/home/logs/nginx.log --content="@{DATE:+%Y-%m-%d %H:%M:%S} ERROR invoke getUser timeout [@{RANDOM:100-200}]ms abc  mock exception" --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_appendfile
    categories:
    - system_file
    actionProcessHang: true
  - action: chmod
    shortDesc: File permission modification.
    longDesc: File perçmission modification.
    matchers:
    - name: filepath
      desc: file path
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    flags:
    - name: mark
      desc: --mark 777
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |
      # Modify /home/logs/nginx.log file permissions to 777
      blade create cri file chmod --filepath /home/logs/nginx.log --mark=777 --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_chmodfile
    categories:
    - system_file
    actionProcessHang: false
  - action: add
    shortDesc: File or path add
    longDesc: File or path add
    matchers:
    - name: filepath
      desc: file path
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    flags:
    - name: directory
      desc: use --directory flag, --filepath is directory
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: content
      desc: --content, add file content
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: enable-base64
      desc: --content use base64 encoding
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: auto-create-dir
      desc: automatically creates a directory that does not exist
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |
      # Create a file named nginx.log in the /home directory
      blade create cri file add --filepath /home/nginx.log --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Create a file named nginx.log in the /home directory with the contents of HELLO WORLD
      blade create cri file add --filepath /home/nginx.log --content "HELLO WORLD" --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Create a file named nginx.log in the /temp directory and automatically create directories that don't exist
      blade create cri file add --filepath /temp/nginx.log --auto-create-dir --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Create a directory named /nginx in the /temp directory and automatically create directories that don't exist
      blade create cri file add --directory --filepath /temp/nginx --auto-create-dir --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_addfile
    categories:
    - system_file
    actionProcessHang: false
  - action: delete
    shortDesc: File delete
    longDesc: File delete
    matchers:
    - name: filepath
      desc: file path
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    flags:
    - name: force
      desc: use --force flag can't be restored
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |
      # Delete the file /home/logs/nginx.log
      blade create cri file delete --filepath /home/logs/nginx.log --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Force delete the file /home/logs/nginx.log unrecoverable
      blade create cri file delete --filepath /home/logs/nginx.log --force --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_deletefile
    categories:
    - system_file
    actionProcessHang: false
  - action: move
    shortDesc: File move
    longDesc: File move
    matchers:
    - name: filepath
      desc: file path
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    flags:
    - name: target
      desc: target folder
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    - name: force
      desc: use --force flag overwrite target file
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: auto-create-dir
      desc: automatically creates a directory that does not exist
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-release
      desc: The pull path of the chaosblade tar package, for example, --chaosblade-release
        /opt/chaosblade-0.4.0.tar.gz
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: chaosblade-override
      desc: Override the exists chaosblade tool in the target container or not, default
        value is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |
      # Move the file /home/logs/nginx.log to /tmp
      blade create cri file delete --filepath /home/logs/nginx.log --target /tmp --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Force Move the file /home/logs/nginx.log to /temp
      blade create cri file delete --filepath /home/logs/nginx.log --target /tmp --force --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08

      # Move the file /home/logs/nginx.log to /temp/ and automatically create directories that don't exist
      blade create cri file delete --filepath /home/logs/nginx.log --target /temp --auto-create-dir --chaosblade-release /root/chaosblade-0.6.0.tar.gz --container-id ee54f1e61c08
    programs:
    - chaos_movefile
    categories:
    - system_file
    actionProcessHang: false
  scope: cri
- target: container
  shortDesc: Execute a container experiment
  longDesc: Execute a container experiment.
  actions:
  - action: remove
    aliases: [rm]
    shortDesc: remove a container
    longDesc: remove a container
    flags:
    - name: force
      desc: force remove
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # Delete the container id that is a76d53933d3f",
      blade create cri container remove --container-id a76d53933d3f. If container-runtime is contained, the container-id shoud be full id
    categories:
    - system_container
    actionProcessHang: false
  scope: cri
- target: network
  shortDesc: Network experiment
  longDesc: Network experiment
  actions:
  - action: drop
    shortDesc: Drop experiment
    longDesc: Drop network data
    matchers:
    - name: source-ip
      desc: The source ip address of packet
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: destination-ip
      desc: The destination ip address of packet
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: source-port
      desc: The source port of packet
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: destination-port
      desc: The destination port of packet
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: string-pattern
      desc: The string that is contained in the packet
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: network-traffic
      desc: The direction of network traffic
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # Block incoming connection from the port 80
      blade create cri network drop --source-port 80 --network-traffic in --container-id ee54f1e61c08
    programs:
    - chaos_dropnetwork
    categories:
    - system_network
    actionProcessHang: false
  - action: dns
    shortDesc: Dns experiment
    longDesc: Dns experiment
    flags:
    - name: domain
      desc: Domain name
      noArgs: false
      required: true
      requiredWhenDestroyed: true
    - name: ip
      desc: Domain ip
      noArgs: false
      required: true
      requiredWhenDestroyed: true
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      # The domain name www.baidu.com is not accessible
      blade create cri network dns --domain www.baidu.com --ip 10.0.0.0 --container-id ee54f1e61c08
    programs:
    - chaos_tcnetwork
    categories:
    - system_network
    actionProcessHang: false
  - action: occupy
    shortDesc: Occupy the specify port
    longDesc: Occupy the specify port, if the port is used, it will return fail, except
      add --force flag
    matchers:
    - name: port
      desc: The port occupied
      noArgs: false
      required: true
      requiredWhenDestroyed: false
    - name: force
      desc: Force kill the process which is using the port
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: cgroup-root
      desc: cgroup root path, default value /sys/fs/cgroup
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    flags:
    - name: container-id
      desc: Container id, when used with container-name, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-name
      desc: Container name, when used with container-id, container-id is preferred
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-repo
      desc: Image repository of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: image-version
      desc: Image version of the chaosblade-tool
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: cri-endpoint
      desc: Cri container socket endpoint
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-runtime
      desc: container runtime, support cri and containerd, default value is docker
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: container-namespace
      desc: container namespace, If container-runtime is containerd it will be used,
        default value is k8s.io
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: timeout
      desc: set timeout for experiment
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    - name: async
      desc: whether to create asynchronously, default is false
      noArgs: true
      required: false
      requiredWhenDestroyed: false
    - name: endpoint
      desc: the create result reporting address. It takes effect only when the async
        value is true and the value is not empty
      noArgs: false
      required: false
      requiredWhenDestroyed: false
    example: |-
      #Specify port 8080 occupancy
      blade create cri network occupy --port 8080 --force --container-id ee54f1e61c08

      # The machine accesses external 14.215.177.39 machine (ping www.baidu.com) 80 port packet loss rate 100%
      blade create cri network loss --percent 100 --interface eth0 --remote-port 80 --destination-ip 14.215.177.39 --container-id ee54f1e61c08
    programs:
    - chaos_occupynetwork
    categories:
    - system_network
    actionProcessHang: true
  scope: cri
